<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payments List</title>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.2/css/buttons.dataTables.min.css">
    <style>
        *,
        *:after,
        *:before {
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            -ms-box-sizing: border-box;
            box-sizing: border-box;
        }

        body {
            font-family: arial;
            font-size: 16px;
            margin: 0;
            background: #fff;
            color: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }

        .container {
            max-width: 1100px;
            width: 100%;
        }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>
    <div class="container">
        <h1>Payments List</h1>
        <% if (payments.length===0) { %>
            <p>No payments found.</p>
            <% } else { %>
                <table id="paymentsTable" class="display nowrap" style="width:100%">
                    <thead>
                        <tr>
                            <th>Customer Account</th>
                            <th>Merchant Account</th>
                            <th>Description</th>
                            <th>Amount</th>
                            <th>Status</th>
                            <th>Date</th>
                            <th>Time</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% payments.forEach(payment=> { %>
                            <tr>
                                <td>
                                    <%= payment.cust_acc %>
                                </td>
                                <td>
                                    <%= payment.mer_acc %>
                                </td>
                                <td>
                                    <%= payment.desc %>
                                </td>
                                <td>
                                    <%= payment.amount %>
                                </td>
                                <td>
                                    <%= payment.status %>
                                </td>
                                <td>
                                    <%= payment.properDate %>
                                </td>
                                <td>
                                    <%= payment.properTime %>
                                </td>
                                <td>
                                    <% if (payment.status==="Pending" ) { %>
                                        <a href="/paymentDetail/pay/<%= payment._id %>"><button>Pay</button></a>
                                        <a href="#" onclick="reject('<%= payment._id %>')"><button>Reject</button></a>
                                        <% } %>
                                </td>

                            </tr>
                            <% }); %>
                    </tbody>
                    <tfoot>
                        <tr>
                            <th>Customer Account</th>
                            <th>Merchant Account</th>
                            <th>Description</th>
                            <th>Amount</th>
                            <th>Status</th>
                            <th>Date</th>
                            <th>Action</th>
                        </tr>
                    </tfoot>
                </table>
                <% } %>
    </div>

    <script src="https://cdn.datatables.net/1.11.4/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.print.min.js"></script>
    <script src="https://cdn.datatables.net/select/2.0.0/js/select.dataTables.js"></script>

    <script>
        $(document).ready(function () {
            $('#paymentsTable').DataTable({
                dom: 'Bfrtip',
                buttons: [
                    'copy', 'csv', 'excel', 'pdf', 'print'
                ]
            });
        });
    </script>

    <script>
        function reject(paymentId) {
            if (confirm('Are you sure you want to delete this product?')) {
                window.location.href = '/reject/' + paymentId;
            }
        }
    </script>
</body>

</html>